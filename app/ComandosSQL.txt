-- Ejecutar en PhpMyAdmin general
CREATE DATABASE IF NOT EXISTS VeciReport;
USE VeciReport

-- Ejecutar en la base de datos de VeciReport

create table provincias(
    id_provincia int not null PRIMARY KEY AUTO_INCREMENT,
	nombre varchar(50) not null    
);

create table cantones(
    id_canton int not null PRIMARY KEY AUTO_INCREMENT,
    id_provincia int not null,
    nombre varchar(50) not null,
    FOREIGN KEY (id_provincia) REFERENCES provincias(id_provincia)
);

create table usuarios(
    id_usuario int not null PRIMARY KEY AUTO_INCREMENT,
    id_canton int not null,
    nombre varchar(50) not null,
    apellido_1 varchar(50) not null,
    apellido_2 varchar(50) not null,
    correo varchar(60) not null,
    password varchar(200) not null,
    rol varchar(50) not null,
    FOREIGN KEY(id_canton) REFERENCES cantones(id_canton)
);

create table telefonos(
    id_telefono int not null PRIMARY KEY AUTO_INCREMENT,
    telefono int not null
);



create table usuarios_telefonos(
    id_usuario_telefono int not null PRIMARY KEY AUTO_INCREMENT,
    id_usuario int not null,
    id_telefono int not null,
    FOREIGN KEY(id_usuario) REFERENCES usuarios(id_usuario),
    FOREIGN KEY(id_telefono) REFERENCES telefonos(id_telefono)
);

create table categorias(
    id_categoria int not null PRIMARY KEY AUTO_INCREMENT,
    nombre varchar(30) not null
);

create table reportes(
    id_reporte int not null PRIMARY KEY AUTO_INCREMENT,
    id_usuario int not null,
    id_categoria int not null,
    titulo varchar(30) not null,
    descripcion varchar(200) not null,
    estado varchar(30) not null,
    prioridad varchar (30) not null,
    id_canton INT,
    FOREIGN KEY (id_canton) REFERENCES cantones(id_canton),
    FOREIGN KEY(id_usuario) REFERENCES usuarios(id_usuario),
    FOREIGN KEY(id_categoria) REFERENCES categorias(id_categoria)
);



create table imagenes(
    id_imagen int not null PRIMARY KEY AUTO_INCREMENT,
    id_reporte int not null,
    direccion varchar(200) not null,
    FOREIGN KEY(id_reporte) REFERENCES reportes(id_reporte)
);

create table encuestas(
    id_encuesta int not null PRIMARY KEY AUTO_INCREMENT,
    titulo varchar(40) not null,
    decripcion varchar(200) not null,
    cantidad_likes int not null,
    cantidad_dislikes int not null,    
    id_usuario int not null,
    FOREIGN KEY(id_usuario) REFERENCES usuarios(id_usuario)
);
