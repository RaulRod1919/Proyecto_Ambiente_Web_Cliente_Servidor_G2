-- Ejecutar en PhpMyAdmin general
CREATE DATABASE IF NOT EXISTS VeciReport;
USE VeciReport

-- Ejecutar en la base de datos de VeciReport

-- Tabla Provincias
CREATE TABLE Provincias (
    id_provincia INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);

-- Tabla Cantones
CREATE TABLE Cantones (
    id_canton INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    id_provincia INT,
    FOREIGN KEY (id_provincia) REFERENCES Provincias(id_provincia)
);

-- Tabla Usuarios
CREATE TABLE Usuarios (
    id_usuario INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    apellido_1 VARCHAR(100) NOT NULL,
    apellido_2 VARCHAR(100),
    correo VARCHAR(150) NOT NULL UNIQUE,
    id_provincia INT,
    FOREIGN KEY (id_provincia) REFERENCES Provincias(id_provincia)
);

-- Tabla Telefonos
CREATE TABLE Telefonos (
    id_telefono INT AUTO_INCREMENT PRIMARY KEY,
    telefono VARCHAR(20) NOT NULL
);

-- Tabla Usuarios_Telefonos
CREATE TABLE Usuarios_Telefonos (
    id_usuario_telefono INT AUTO_INCREMENT PRIMARY KEY,
    id_usuario INT,
    id_telefono INT,
    FOREIGN KEY (id_usuario) REFERENCES Usuarios(id_usuario),
    FOREIGN KEY (id_telefono) REFERENCES Telefonos(id_telefono)
);

-- Tabla Categorias
CREATE TABLE Categorias (
    id_categoria INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);

-- Tabla Reportes
CREATE TABLE Reportes (
    id_reporte INT AUTO_INCREMENT PRIMARY KEY,
    titulo VARCHAR(200) NOT NULL,
    descripcion TEXT,
    estado VARCHAR(50),
    prioridad VARCHAR(50),
    id_categoria INT,
    id_usuario INT,
    id_canton INT,
    FOREIGN KEY (id_canton) REFERENCES cantones(id_canton),
    FOREIGN KEY (id_categoria) REFERENCES Categorias(id_categoria),
    FOREIGN KEY (id_usuario) REFERENCES Usuarios(id_usuario)
);

-- Tabla Reportes_Administradores
CREATE TABLE Reportes_Administradores (
    id_reporte_admin INT AUTO_INCREMENT PRIMARY KEY,
    id_admin INT,
    id_reporte INT,
    FOREIGN KEY (id_admin) REFERENCES Administradores(id_admin),
    FOREIGN KEY (id_reporte) REFERENCES Reportes(id_reporte)
);

-- Tabla Imagenes
CREATE TABLE Imagenes (
    id_imagen INT AUTO_INCREMENT PRIMARY KEY,
    direccion VARCHAR(255) NOT NULL,
    id_reporte INT,
    FOREIGN KEY (id_reporte) REFERENCES Reportes(id_reporte)
);
